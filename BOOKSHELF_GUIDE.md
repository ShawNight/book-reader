# 📚 书架功能使用指南

## ✨ 新增功能

### 1. 收藏书籍到书架
有两种方式可以添加书籍到书架：

#### 方式1：搜索结果直接添加
```
搜索小说 → 搜索结果列表 → 点击右侧⊕按钮 → 加入书架
```

#### 方式2：章节页面收藏
```
搜索小说 → 点击进入章节列表 → 点击右上角书签图标 → 加入书架
```

---

### 2. 书架管理

#### 查看书架
- 点击底部【书架】标签
- 显示所有收藏的书籍
- 按添加时间排序（最新在前）

#### 书籍信息显示
```
┌─────────────────────────────────┐
│ 📖 斗破苍穹                     │
│    作者：天蚕土豆                │
│    读到：第十章 xxx（蓝色）      │
│    最新：第一千章 xxx            │
│    来源：御龙小说网              │
└─────────────────────────────────┘
```

#### 删除书籍
- **左滑删除：** 在书架中向左滑动书籍
- 出现红色删除区域
- 继续滑动即可删除

---

### 3. 阅读进度追踪

#### 自动保存进度
当你阅读章节时：
- ✅ 自动记录当前章节
- ✅ 记录章节名称
- ✅ 返回书架时显示"读到：xxx"

#### 继续阅读
- 点击书架中的书籍
- 直接跳转到章节列表
- 选择章节继续阅读

---

## 🎯 完整使用流程

### 第一次使用
```
1. 导入书源
   书源标签 → 右上角+ → 选择书源.json

2. 搜索小说
   书架标签 → 右上角🔍 → 输入"斗破"

3. 加入书架
   搜索结果 → 点击右侧⊕

4. 开始阅读
   点击书籍 → 选择章节 → 阅读
```

### 日常使用
```
1. 打开书架
   查看收藏的书籍

2. 继续阅读
   点击书籍 → 看到章节列表

3. 管理书架
   左滑删除不想看的书

4. 添加新书
   搜索 → 添加到书架
```

---

## 💡 功能细节

### 搜索结果页面
- **⊕按钮：** 快速加入书架（不进入章节列表）
- **点击书籍：** 进入章节列表查看详情
- **加入成功：** 显示提示"《书名》已加入书架"

### 章节列表页面
- **书签图标：**
  - 实心书签 = 已在书架
  - 空心书签 = 未在书架
- **点击书签：** 切换收藏/取消收藏
- **取消收藏：** 提示"已从书架移除"

### 阅读页面
- **自动追踪：** 翻页时自动保存进度
- **进度同步：** 返回书架后显示最新阅读位置
- **无缝切换：** 可以在任何章节退出，下次继续

---

## 🗂️ 数据存储

### 存储位置
```
~/.local/share/yuedu_flutter/
├── bookshelf.json          # 书架数据
├── book_sources/           # 书源数据
│   └── sources.json
```

### 备份数据
```bash
# 备份书架
cp ~/.local/share/yuedu_flutter/bookshelf.json ~/bookshelf_backup.json

# 备份书源
cp -r ~/.local/share/yuedu_flutter/book_sources ~/book_sources_backup/
```

### 恢复数据
```bash
cp ~/bookshelf_backup.json ~/.local/share/yuedu_flutter/bookshelf.json
```

---

## ⚠️ 注意事项

1. **网络要求**
   - 搜索小说需要网络
   - 加载章节需要网络
   - 离线可以使用书架（但无法更新章节）

2. **书源有效性**
   - 书源可能失效
   - 建议多导入几个书源
   - 某些书源可能有反爬限制

3. **数据安全**
   - 数据存储在本地
   - 卸载应用会丢失数据
   - 建议定期备份

4. **性能优化**
   - 章节自动缓存
   - 图片懒加载
   - 列表虚拟滚动

---

## 🐛 已知问题

- [ ] 书架排序方式（暂只支持添加时间）
- [ ] 书籍分组/分类
- [ ] 批量管理（多选删除）
- [ ] 阅读统计（总时长、字数）
- [ ] 云同步功能

---

## 🎨 界面预览

### 搜索结果（带加入书架按钮）
```
┌─────────────────────────────────┐
│ [🔍 斗破...]            [🔍]    │
├─────────────────────────────────┤
│ 📖 斗破苍穹              ⊕      │
│    作者：天蚕土豆               │
│    最新：第1645章               │
│    来源：御龙小说网             │
├─────────────────────────────────┤
│ 📖 斗罗大陆              ⊕      │
│    作者：唐家三少               │
│    最新：第1200章               │
│    来源：梧桐中文               │
└─────────────────────────────────┘
```

### 章节列表（带收藏按钮）
```
┌─────────────────────────────────┐
│ 斗破苍穹          [🔖] [🔄]    │
├─────────────────────────────────┤
│ ① 第一章 陨落的天才             │
│ ② 第二章 斗之气段               │
│ ③ 第三章 客人                   │
│ ...                             │
└─────────────────────────────────┘
```

### 书架（带阅读进度）
```
┌─────────────────────────────────┐
│ 我的书架                [🔍]    │
├─────────────────────────────────┤
│ 📖 斗破苍穹              ←删除  │
│    作者：天蚕土豆               │
│    读到：第100章 xxx            │
│    最新：第1645章 xxx           │
│    来源：御龙小说网             │
├─────────────────────────────────┤
│ 📖 斗罗大陆                     │
│    作者：唐家三少               │
│    读到：第50章 xxx             │
│    最新：第1200章 xxx           │
│    来源：梧桐中文               │
└─────────────────────────────────┘
```

---

## 📊 功能对比

| 功能 | 之前 | 现在 |
|------|------|------|
| 书架展示 | ❌ 占位符 | ✅ 完整列表 |
| 收藏书籍 | ❌ 无 | ✅ 两种方式 |
| 阅读进度 | ❌ 无 | ✅ 自动保存 |
| 删除书籍 | ❌ 无 | ✅ 左滑删除 |
| 进度显示 | ❌ 无 | ✅ 章节名称 |

---

**现在你的阅读App已经有完整的书架功能了！** 🎉
